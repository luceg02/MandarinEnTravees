{% extends 'base.html.twig' %}

{% block title %}Le Mandarin en Travées - Fact-checking collaboratif{% endblock %}

{% block stylesheets %}
    <link href="{{ asset('css/homepage.css') }}" rel="stylesheet">
{% endblock %}

{% block body %}
    <!-- Header avec navigation -->
    <header class="main-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-3">
                    <div class="logo-container">
                        <div class="logo-icon">M</div>
                        <span class="logo-text">LE MANDARIN<br><small style="font-size: 0.7em;">EN TRAVÉES</small></span>
                    </div>
                </div>
                <div class="col-md-6 text-center">
                        <nav>
    {% for categorie in categories %}
        <a href="#" class="nav-link">{{ categorie.nom|upper }}</a>
    {% endfor %}
                    </nav>
                </div>
                <div class="col-md-3 text-end">
                    <div class="d-flex align-items-center justify-content-end">
                        <input type="text" placeholder="Rechercher..." class="search-input">
                        <a href="/login" style="color: white; font-size: 1.5rem;"><i class="fas fa-user-circle"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Section héro bleue -->
    <section class="hero-section">
        <div class="container">
            <h1 class="hero-title">Combattons les Fake News ensemble</h1>
            <p class="hero-subtitle">Rejoignez la communauté la plus active de fact-checkers et gagnez en réputation en défendant la vérité</p>
            <a href="/inscription" class="cta-button">Soumettre une vérification</a>
        </div>
    </section>

    <!-- Contenu principal -->
    <main class="main-content">
        <div class="container">
            <div class="row">
                <!-- Colonne gauche - Fact-checks -->
                <div class="col-lg-8">
                    <h2 class="section-title">Derniers Fact-checks</h2>

                    {% if demandes is defined and demandes|length > 0 %}
                        <!-- Données de la BD -->
                        {% for demande in demandes %}
                            <div class="fact-check-card">
                                <div class="d-flex justify-content-between align-items-start mb-3">
                                    <span class="status-badge status-{{ demande.statut|lower|replace({' ': '-'}) }}">
                                        {{ demande.statut|upper }}
                                    </span>
                                    <span class="card-meta">
                                        {{ demande.dateCreation|date('H\\hi') }} • {{ demande.categorie.nom|lower }}
                                    </span>
                                </div>
                                <h3 class="card-title">{{ demande.titre }}</h3>
                                <p class="card-excerpt">{{ demande.description|slice(0, 150) }}...</p>
                                <div class="d-flex justify-content-between align-items-center card-footer">
                                    <span style="color: #4a5568; font-weight: 500;">{{ demande.auteur.username }}</span>
                                    <span style="color: #718096; font-size: 0.9rem;">{{ demande.nbReponses }} réponse{{ demande.nbReponses > 1 ? 's' : '' }}</span>
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <!-- Données fictives temporaires -->
                        <div class="fact-check-card">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <span class="status-badge status-vrai">VRAI</span>
                                <span class="card-meta">Il y a 2h • politique</span>
                            </div>
                            <h3 class="card-title">Le gouvernement a-t-il vraiment augmenté les impôts de 15% cette année ?</h3>
                            <p class="card-excerpt">Après vérification des données officielles de Bercy, l'augmentation moyenne s'élève à 15% comme annoncé dans plusieurs publications sur les réseaux sociaux...</p>
                            <div class="d-flex justify-content-between align-items-center card-footer">
                                <span style="color: #4a5568; font-weight: 500;">Pierre Martin</span>
                                <span style="color: #718096; font-size: 0.9rem;">8 réponses</span>
                            </div>
                        </div>

                        <div class="fact-check-card">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <span class="status-badge status-faux">FAUX</span>
                                <span class="card-meta">Il y a 4h • société</span>
                            </div>
                            <h3 class="card-title">Les voitures électriques polluent-elles plus que les thermiques ?</h3>
                            <p class="card-excerpt">Une analyse du cycle de vie montre que l'empreinte carbone des véhicules électriques reste inférieure aux thermiques...</p>
                            <div class="d-flex justify-content-between align-items-center card-footer">
                                <span style="color: #4a5568; font-weight: 500;">Marie Dupont</span>
                                <span style="color: #718096; font-size: 0.9rem;">12 réponses</span>
                            </div>
                        </div>
                    {% endif %}
                </div>

                <!-- Sidebar droite -->
                <aside class="col-lg-4" style="padding-left: 2rem;">
                    <!-- Top contributeurs -->
                    <div class="sidebar-section">
                        <h3 class="sidebar-title">Top contributeurs</h3>
                        {% if topContributeurs is defined and topContributeurs|length > 0 %}
                            {% for contributeur in topContributeurs %}
                                <div class="contributor-item">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <div style="color: #4a5568; font-weight: 500; font-size: 0.9rem;">{{ contributeur.username }}</div>
                                            <div style="color: #718096; font-size: 0.8rem;">
                                                {% if contributeur.roles is defined and 'ROLE_JOURNALIST' in contributeur.roles %}
                                                    Journaliste
                                                {% else %}
                                                    Contributeur
                                                {% endif %}
                                            </div>
                                        </div>
                                        <div class="contributor-score">{{ (contributeur.scoreReputation / 1000)|number_format(1) }}K</div>
                                    </div>
                                </div>
                            {% endfor %}
                        {% else %}
                            <!-- Données fictives -->
                            <div class="contributor-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <div style="color: #4a5568; font-weight: 500; font-size: 0.9rem;">Pierre Martin</div>
                                        <div style="color: #718096; font-size: 0.8rem;">Journaliste</div>
                                    </div>
                                    <div class="contributor-score">1.2K</div>
                                </div>
                            </div>
                        {% endif %}
                    </div>

                    <!-- Tendances (toujours fictives) -->
                    <div class="sidebar-section">
                        <h3 class="sidebar-title">Tendances du jour</h3>
                        <div style="padding: 0.75rem 0; border-bottom: 1px solid #f1f5f9;">
                            <div style="color: #4a5568; font-weight: 500; font-size: 0.9rem;">Élections européennes (12 questions)</div>
                        </div>
                        <div style="padding: 0.75rem 0;">
                            <div style="color: #4a5568; font-weight: 500; font-size: 0.9rem;">Inflation alimentaire (8 questions)</div>
                        </div>
                    </div>

                    <!-- Statistiques -->
                    <div class="sidebar-section text-center">
                        {% if stats is defined %}
                            <div style="margin-bottom: 2rem;">
                                <span class="stats-number">{{ stats.totalDemandes|number_format(0, ',', '.') }}</span>
                                <span class="stats-label">Fact-checks publiés</span>
                            </div>
                            <div>
                                <span class="stats-number">{{ stats.totalUtilisateurs|number_format(0, ',', '.') }}</span>
                                <span class="stats-label">Contributeurs actifs</span>
                            </div>
                        {% else %}
                            <!-- Données fictives -->
                            <div style="margin-bottom: 2rem;">
                                <span class="stats-number">1,247</span>
                                <span class="stats-label">Fact-checks publiés</span>
                            </div>
                            <div>
                                <span class="stats-number">700</span>
                                <span class="stats-label">Contributeurs actifs</span>
                            </div>
                        {% endif %}
                    </div>
                </aside>
            </div>
        </div>
    </main>
{% endblock %}